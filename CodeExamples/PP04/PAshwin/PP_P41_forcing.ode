# Paillard Parrenin model with 41k forcing
# and params from Michel Crucifix
# Peter Ashwin
# 17/5/17
# (run using xppaut)

init IV=1.0
init AA=0.0
init mu=0.0


# internal parameters
par a=1.3
par b=0.5
par c=0.8
par d=0.15
par e=0.5
par f=0.5
par g=0.4
par h=0.3
par i=0.7
par j=0.27
par taui=15
par taua=12
par taumu=5
par KK=100

par kth=4.444444e-2
#forcing amplitude and freqs
par kt=1.0
par tf=40.0

# noise strength
#par xix=0.00
#par xiy=0.00


# random forcing
wiener w[0..1]

omega=2*3.141592635/tf
#omega2=2*3.141592635/tf2

# forcing
#AF=sin(omega1*t)+sin(omega2*t)
AF=kt*sin(omega*t)

# approx Heaviside
HH(x)=(1+tanh(KK*x))/2

# evolution equations
# NB heav() is Heaviside function
IV'=(-a*mu-b*AF+c-IV)/taui
AA'=(IV-AA)/taua
mu'=(d*AF-e*IV+f*HH(-(h*IV-i*AA+j))+g-mu)/taumu

# astro forcing term
aux A=AF

# defaults
@ T0=0.0
@ dt=0.05, total=1000, xplot=T, yplot=IV
@ xmin=0,xmax=1000,ymin=-1,ymax=1

@ xlo=0, ylo=-1, xhi=1000, yhi=1, bound=10000, maxstor=10000000
done

#############################
# Fourier components of astronomical forcing
# from Table 1 of de Saladaer et al Climate Dynamics (2013)
# F(t)=sum_i (s(i)*sin(omega(i)*t)+c(i)*cos(omega(i)*t)))
om0=0
om1=0.153249478547167
om2=0.158148666238883
om3=0.117190147169570
om4=0.155061775112933
om5=0.217333905941751
om6=0.150162587421217
om7=0.211709630908568
om8=0.156336369673117
om9=0.148350290855451
om10=0.206924898030688
om11=0.212525165090383
om12=0.229992875969202
om13=0.306498957094334
om14=0.311398144786051
om15=0.004899187691716
om16=0.264933601588513 
om17=0.280151350350945
om18=0.331110950251899
om19=0.328024059125949
om20=0.326211762560183
om21=0.269742342439881
om22=0.332923246817665
om23=0.371638925683567
om24=0.275366617473065
om25=0.323124871434233
om26=0.259396912994958
om27=0.324937167999999
om28=0.334197841377850
om29=0.274551083291250
om30=0.418183080135680
om31=0.111684123041346
om32=0.433400828898112
om33=0.126901871803777
om34=0.336010137943616
om35=0.177861471704732


s0=0
s1=-11.2287376815124
s2=-3.82499371467540
s3=2.28814805956066
s4=-1.29770081956440
s5=0.380973541305497
s6=1.54904176353302
s7=-0.810768209286259
s8=-0.918358442095885
s9=0.256895610735773
s10=-0.335783913402678
s11=0.267659228540196
s12=0.0696189733188958
s13=0.0247349748169616
s14=0.0138353727621181
s15=-0.160479848721994
s16=-15.5490493322904
s17=15.4319556361701
s18=9.0992249352734
s19=-7.87065384013669
s20=0.813786144754451
s21=0.0690448504314857
s22=1.44050770785967
s23=0.925324276580528
s24=0.997628846513796 
s25=-0.378637986107629
s26=0.339477750517033
s27=-0.576082669762308
s28=0.346906064369828
s29=-0.441772417569753
s30=-0.0184884064645011
s31=-0.428006728186239
s32=-0.0049199219454561
s33=0.257509918217341
s34=-0.421809264016129
s35=-0.161827722328271

c0=0
c1=3.51682075211241
c2=-0.761851750263805
c3=1.80233702684623
c4=-0.635152963728496
c5=-1.46301711999210
c6=-0.0883941912769817
c7=-0.577980646565494
c8=0.196083726889428
c9=-0.524697312305024
c10=-0.0194792150128644
c11=0.128915417116900
c12=0.0746231714061285
c13=0.0140464395340974
c14=0.0304736668840422
c15=0.0594077968934257
c16=-9.70406287110532
c17=4.75247271131525
c18=-10.6115244887390
c19=6.61544246063503
c20=-4.52641408099246
c21=-3.31639260969558
c22=1.06339286050120
c23=-1.02066758672154
c24=-0.362906496840039
c25=0.527217891742183
c26=-0.560509461538342
c27=1.18669572739338
c28=-0.648189701487285
c29=0.289576210423804
c30=0.109632390175297
c31=0.357006342316690
c32=-0.106148873639336
c33=-0.377639794223366
c34=0.324327509437558
c35=-0.362683869407858
